window.mk?mk.u||(mk.u={}):window.mk={u:{}},mk.u.toBoolean=function(e){if("boolean"==typeof e)return e;if("number"==typeof e)return Boolean(e);if(null===e||void 0===e)return!1;if(e instanceof Array)return Boolean(e.length);if("object"==typeof e)return Boolean(mk.u.objectLength(e));if("string"!=typeof e)return Boolean(e);switch(e=e.trim()){case"":return!1;case"false":return!1;case"true":return!0;case"0":return!1;case"1":return!0;default:return!0}},window.mk?mk.u||(mk.u={}):window.mk={u:{}},mk.u.log=function(){for(var e=" \n",t="",n=0;n<arguments.length;n++){var r=arguments[n];t+="object"==typeof r?mk.u.obj2str(r):r,t+=e}alert(t)},mk.u._isDebug=function(){return!!window.CFG&&!!CFG.debugMode},mk.u.obj2str=function(e,t,n){if(0===t)return"{.depth exceeded.}";void 0===t&&(t=3),n||(n="");var r=" ",a="";for(var i in e)e.hasOwnProperty(i)&&("function"==typeof e[i]?a+=n+i+": function() \n":"object"==typeof e[i]?(a+=n+i+": \n"+n+r,a+=mk.u.obj2str(e[i],t-1,n+r),a+=" \n"):a+=n+i+": "+e[i]+" \n");return a},mk.u.j=function(e){return JSON.stringify(e,null,4)},window.mk?mk.u||(mk.u={}):window.mk={u:{}},mk.u.isInArray=function(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return!0;return!1},mk.u.getFromArray=function(e,t,n){for(var r,a=0;a<e.length;a++)if(n===e[a][t]){r=e[a];break}return r},mk.u.pushUnique=function(e,t){for(var n=1;n<arguments.length;n++){if(t=arguments[n],mk.u.isInArray(e,t))return e.length;e.push(t)}return e.length},mk.u.removeValFromArray=function(e,t){for(var n=1;n<arguments.length;n++){t=arguments[n];var r=e.indexOf(t);-1!==r&&e.splice(r,1)}return e.length},window.mk?mk.u||(mk.u={}):window.mk={u:{}},mk.u.objectLength=function(e){if(null!==e&&void 0!==e){var t=0;for(var n in e)e.hasOwnProperty(n)&&t++;return t}},mk.u.merge=function(){if(0===arguments.length)return{};for(var e={},t=0;t<arguments.length;t++){var n=arguments[t];for(var r in n)n.hasOwnProperty(r)&&("object"==typeof n[r]?("object"!=typeof e[r]&&(e[r]={}),e[r]=mk.u.merge(e[r],n[r])):e[r]=n[r])}return e},mk.u.mixInto=function(e,t){for(var n=1;n<arguments.length;n++){t=arguments[n];for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}return e},mk.u.mixUniqueInto=function(e,t){for(var n=[],r=1;r<arguments.length;r++){t=arguments[r];for(var a in t)t.hasOwnProperty(a)&&(void 0===e[a]?e[a]=t[a]:n.push(a))}return n.length&&console.warn("Duplicating properties were skipped while mixing: "+n.join(", ")),e},mk.u.extendClass=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.prototype.superclass=t.prototype},mk.u.clone=function(e){var t;if(e instanceof Array){t=[];for(var n=0;n<e.length;n++)"object"==typeof e[n]&&null!==e[n]?t.push(mk.u.clone(e[n])):t.push(e[n])}else{t={};for(var n in e)e.hasOwnProperty(n)&&("object"==typeof e[n]&&null!==e[n]?t[n]=mk.u.clone(e[n]):t[n]=e[n])}return t},window.mk?mk.u||(mk.u={}):window.mk={u:{}},mk.u.addClass=function(e,t){var n=new RegExp("(^|\\s)"+t+"(\\s|$)","g");n.test(e.className)||(e.className=(e.className+" "+t).replace(/\s+/g," ").replace(/(^ | $)/g,""))},mk.u.removeClass=function(e,t){var n=new RegExp("(^|\\s)"+t+"(\\s|$)","g");e.className=e.className.replace(n,"$1").replace(/\s+/g," ").replace(/(^ | $)/g,"")},mk.u.toggleClass=function(e,t){var n=new RegExp("(^|\\s)"+t+"(\\s|$)","g");n.test(e.className)?e.className=e.className.replace(n,"$1").replace(/\s+/g," ").replace(/(^ | $)/g,""):e.className=(e.className+" "+t).replace(/\s+/g," ").replace(/(^ | $)/g,"")},mk.u.hasClass=function(e,t){var n=new RegExp("(^|\\s)"+t+"(\\s|$)","g");return n.test(e.className)},mk.u.wrap=function(e,t,n){var r=document.createElement(t);if(n)for(var a in n)r.setAttribute(a,n[a]);return e.parentNode.insertBefore(r,e),r.appendChild(e),r},mk.u.fillElement=function(e,t,n){void 0===n&&(n="data-key");for(var r in t)if(t.hasOwnProperty(r))for(var a=e.querySelectorAll("["+n+'="'+r+'"]'),i=0;i<a.length;i++)a[i].innerHTML=t[r];return e},mk.u.includeFile=function(e,t){jQuery.ajax({url:e,data:{},method:"GET",dataType:"text",success:function(e,n,r){$(t).html(e)},error:function(e,t,n){throw new Error("Не удалось загрузить файл."+n)},async:!1})},mk.u.writeLink=function(e,t,n){e instanceof Array||(e=[e]),void 0===t&&(t=""),void 0===n&&(n="");for(var r,a,i,o=0;o<e.length;o++){if(a=t+e[o]+n,i=a.replace(/\?.+$/,""),".js"===i.substr(-3))r='<script type="text/javascript" src="'+a+'"></script>';else if(".css"===i.substr(-4))r='<link rel="stylesheet" type="text/css" href="'+a+'" />';else{if(".less"!==i.substr(-5))throw new Error("Невозможно прилинковать файл "+a+" - поддерживаются файлы .js, .css или .less");r='<link rel="stylesheet/less" type="text/css" href="'+a+'" />'}document.write(r)}},mk.u.appendLink=function(e,t,n){e instanceof Array||(e=[e]),void 0===t&&(t=""),void 0===n&&(n="");for(var r,a,i,o=0;o<e.length;o++){if(a=t+e[o]+n,i=a.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/^.*\./,""),"js"===i)r=document.createElement("script"),r.type="text/javascript",r.src=a;else if("css"===i)r=document.createElement("link"),r.type="text/css",r.rel="stylesheet",r.href=a;else{if("less"!==i)throw new Error("Невозможно прилинковать файл "+a+" - поддерживаются файлы .js, .css или .less");r=document.createElement("link"),r.type="text/css",r.rel="stylesheet/less",r.href=a}document.head.appendChild(r)}},mk.u.appendLinkOnce=function(e,t,n){e instanceof Array||(e=[e]),void 0===t&&(t=""),void 0===n&&(n="");for(var r,a,i,o=0;o<e.length;o++){if(a=t+e[o]+n,i=a.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/^.*\./,""),"js"===i){if(document.querySelector("script[src="+a+"]"))continue;r=document.createElement("script"),r.type="text/javascript",r.src=a}else if("css"===i){if(document.querySelector("link[href="+a+"]"))continue;r=document.createElement("link"),r.type="text/css",r.rel="stylesheet",r.href=a}else{if("less"!==i)throw new Error("Невозможно прилинковать файл "+a+" - поддерживаются файлы .js, .css или .less");if(document.querySelector("link[href="+a+"]"))continue;r=document.createElement("link"),r.type="text/css",r.rel="stylesheet/less",r.href=a}document.head.appendChild(r)}},window.mk?mk.u||(mk.u={}):window.mk={u:{}},mk.u.p=function(e){$.mkmodal.open({content:e})},mk.u.err=function(e){void 0===e.bubbles&&$.mkmodal.open({title:"Ошибка",content:e})},mk.u.ex=function(e){$.mkmodal.open({title:"Exception",content:e.message}),mk.u._isDebug()&&console.error(e)},mk.u.windowOnError=function(e,t,n){mk.u._isDebug()?(mk.u.err(e+"<br />line: "+n+"<br />url: "+t),console.error("window.onerror: "+e+"<br />line: "+n+"<br />url: "+t)):mk.u.err(e)},window.mk?mk.u||(mk.u={}):window.mk={u:{}},mk.u.formatTimespan=function(e,t,n){var r=Math.floor(e/1e3);t=void 0!==t&&t;var a=Math.floor(r/86400),i=r%86400,o=Math.floor(i/3600);i%=3600;var s=Math.floor(i/60),l="";return t?l+=0!==a?a+n[0]:0!==o?o+Math.round(s/60)+n[1]:s:(0!==a&&(l+=""+a+n[0]),0!==o&&(l+="&nbsp;"+o+n[1]),l+="&nbsp;"+s+n[2]),l},mk.u.makedate=function(e){var t=[];if(/\d:\d/.test(e)){var n=/[:\d]{3,12}$/.exec(e),r=n[0];if(!r)throw new Error("cant extract time string from string "+e);if(t=r.split(":"),t.length<2||t.length>4)throw new Error("cant recognize time string "+r+" from string "+e)}for(;t.length<4;)t.push(0);var a=[];if(/\d[\.-]\d/.test(e)){var i=RegExp("^[\\.-\\d]{4,10}"),o=i.exec(e),s=o[0];if(!s)throw new Error("cant extract date string from string "+e);if(a=s.split(/[\.-]/),a.length<2||a.length>3)throw new Error("cant recognize date string "+s+" from string "+e);for(4===a[a.length-1].length&&a.reverse();a.length<3;)a.push(1)}else{var l=new Date;a[0]=l.getFullYear(),a[1]=l.getMonth()+1,a[2]=l.getDate()}return new Date(a[0],a[1]-1,a[2],t[0],t[1],t[2],t[3])},function(){_hasSibling=function(e){return!!e.nextSibling||!!e.previousSibling},_wrap=function(e){var t=document.createElement("span");return e.parentNode.insertBefore(t,e),t.appendChild(e),t},_getTextNodesIn=function(e){var t=[];if(e)for(var n=e.childNodes,r=n.length;r--;){var a=n[r],i=a.nodeType;if(3===i){if(!a.nodeValue.trim())continue;if(a.parentNode.getAttribute("data-str"))continue;t.push(a)}else 1!==i&&9!==i&&11!==i||(t=t.concat(_getTextNodesIn(a)))}return t},localizer={transtable:null,localeName:null,defaultLocaleName:"en",scanText:!0,scanAttr:!0,warn:!0,process:function(e){if(e||(e=document),this.scanText)for(var t=_getTextNodesIn(e),n=0;n<t.length;n++){var r=t[n],a=r.nodeValue.trim();if(a&&this.transtable[a]){var i;i=_hasSibling(r)?_wrap(r):r.parentNode,i.setAttribute("data-str",a),r.nodeValue=this.m(a)}}if(this.scanAttr)for(var o=e.querySelectorAll("[data-str]"),s=0;s<o.length;s++){var l=o[s],c=l.getAttribute("data-str");c&&(this.transtable[c]?l.innerHTML=this.m(c):l.innerHTML=c)}},m:function(e){return localizer.transtable?localizer.transtable[e]?localizer.transtable[e]:(this.warn&&console.warn("No localized message for alias ",e),e):(this.warn&&console.warn("No localizer transtable set"),e)},f:function(e){for(var t=1;t<arguments.length;t++)e=e.replace("%s",arguments[t]);return e},mf:function(e){return arguments[0]=this.m(e),this.f.apply(null,arguments)},numerous:function(e,t){if("string"==typeof t)return t;if(1===t.length)return t[0];if(2===t.length)return 1===e?t[0]:t[1];if(3===t.length){var n=Number(String(e).substr(-1));if(NaN===n)throw new Error("Not a number");return 1===n?t[0]:n>1&&n<5?t[1]:t[2]}throw new Error("Wrong argument format")},getBrowserLocale:function(){var e=navigator.userLanguage||navigator.language||navigator.browserLanguage||navigator.systemLanguage,t=/^[a-zA-Z]+/.exec(e);if(!t)return null;var n=t[0].toLowerCase();return n},setLocale:function(e){if(e||(e=this.getBrowserLocale()),"string"==typeof e){if(!this.locales)throw new Error("There are no pool of locales. Set localizer.locales first.");if(!this.locales[e]&&(console.warn("There are no locale set with name "+e+"."),e=this.defaultLocaleName,!this.locales[e]))throw new Error("There are no default locale set with name "+e+".");this.transtable=this.locales[e],this.localeName=e}else this.transtable=e;return this}}}(),window.mk?mk.mixin||(mk.mixin={}):window.mk={mixin:{}},mk.mixin.keep={keeped:{},keepedKey:"_keeper_",copyKeepedToSelf:!1,keep:function(e,t){if(""===this.keepedKey)throw new Error("Не задан объектный ключ для localStorage");if(void 0===t)return this.keeped[e];this.keeped[e]=t,this.copyKeepedToSelf&&(this[e]=t);try{localStorage.setItem(this.keepedKey,JSON.stringify(this.keeped))}catch(n){console.warn("Не могу сохранить локальные данные. "+n.message)}return t},keepOff:function(e){if(""===this.keepedKey)throw new Error("Не задан объектный ключ для localStorage");var t;if("undefined"==typeof e){if(t=this.keeped,localStorage.removeItem(this.keepedKey),this.copyKeepedToSelf)for(var n in this.keeped)this.keeped.hasOwnProperty(n)&&delete delete this[n];this.keeped={}}else{if(void 0===this.keeped[e])return;t=this.keeped[e],delete this.keeped[e],localStorage[this.keepedKey]=JSON.stringify(this.keeped),this.copyKeepedToSelf&&delete this[e]}return t},recallKeeped:function(){if(void 0!==localStorage[this.keepedKey])return this.keeped=JSON.parse(localStorage[this.keepedKey]),this.copyKeepedToSelf&&this.applyKeeped(),this.keeped},applyKeeped:function(){for(var e in this.keeped)this.keeped.hasOwnProperty(e)&&(this[e]=this.keeped[e])}},mk.mixin.keep.keepoff=mk.mixin.keep.keepOff,window.mk?mk.mixin||(mk.mixin={}):window.mk={mixin:{}},mk.mixin.events={on:function(e,t){this._eventHandlers||(this._eventHandlers={});for(var n=e.split(" "),r=0;r<n.length;r++){var a=n[r];this._eventHandlers[a]||(this._eventHandlers[a]=[]),this._eventHandlers[a].push(t)}},off:function(e,t){var n=this._eventHandlers[e];if(n)for(var r=0;r<n.length;r++)n[r]===t&&n.splice(r--,1)},trigger:function(e,t){if(this.eventsLogTag){var n=this._eventHandlers&&this._eventHandlers[e]?this._eventHandlers[e].length:0;console.log(this.eventsLogTag+": emit "+e+" for "+n+" handlers")}if(this._eventHandlers&&this._eventHandlers[e]){for(var r=this._eventHandlers[e],a=0;a<r.length;a++)r[a].call(this,t);return this}},fire:function(e,t){this.trigger(e,t)}},function(e){e.cssanim={useAnimationEvents:!0},e.fn.cssanim=function(t,n){var r=e.extend({duration:.3,timing:"ease-out",delay:0,iterationCount:1,direction:"normal",fillMode:"none",oncomplete:function(){}},n);t=t||"mka-fade-in";var a=this;if(void 0===this.css("animationName"))r.oncomplete.call(this,this);else{var i=t+" "+r.duration+"s "+r.timing+" "+r.delay+"s "+r.iterationCount+" "+r.direction+" "+r.fillMode;if(this.css({"-webkit-animation":i,"-ms-animation":i,animation:i}),e.cssanim.useAnimationEvents){var o="animationend webkitAnimationEnd  MSAnimationEnd oanimationend";this.one(o,function(e){a.css({"-webkit-animation":"","-ms-animation":"",animation:""}),r.oncomplete.call(a,a)})}else setTimeout(function(){a.css({"-webkit-animation":"","-ms-animation":"",animation:""}),r.oncomplete.call(a,a)},1e3*(r.duration+.2))}return this},e.fn.cssanimRemove=function(e,t){return t=t||{},t.fillMode=t.fillMode||"forwards",t.oncomplete=function(){this.remove()},this.cssanim(e,t),this},e.fn.cssanimHide=function(e,t){return t=t||{},t.fillMode=t.fillMode||"forwards",t.oncomplete=function(){this.css({display:"none"})},this.cssanim(e,t),this},e.fn.cssanimout=function(e,t){t=t||{},t.fillMode=t.fillMode||"forwards",t.oncomplete=function(){this.remove()},this.cssanim(e,t)}}(jQuery),function(e){var t,n,r,a;e.fn.databridge=function(s,l){t=this,n=t.find("[name], [data-name]"),r=s?s:{},a={};var c=e.extend({},e.fn.databridge.defaults,l);return s?(i(s,c),this):o()},e.fn.databridge.defaults={mapUndefined:!1,mapNull:!1,undefinedVal:"undefined",nullVal:"null"};var i=function(e,t){n.each(function(){var n=u(this),r=s(e,n);void 0!==r&&f(this,r,t)})},o=function(){return n.each(function(){l(r,u(this),h(this))}),r},s=function(e,t){for(var n,r=t.split("."),a=e,i=0;i<r.length;i++){if(n=r[i],void 0===a[n])return;a=a[n]}return a},l=function(e,t,n){var r=t.split(".");if(1===r.length)e[t]=n;else for(var a,i=e,o=0;o<r.length;o++)a=r[o],i[a]||(o+1===r.length?c(a)?i[Number(a)]=n:i[a]=n:i[a]=c(r[o+1])?[]:{}),i=i[a]},c=function(e){return/^\d+$/.test(e)},u=function(e){var t=e.getAttribute("name")||e.getAttribute("data-name");return t=t.replace(/\[/g,"."),t=t.replace(/\]/g,"")},d=function(e,t,n,r){var a;return"set"===t?void 0===e?r.mapUndefined?a=m(n):"function"==typeof r.undefinedVal?a=r.undefinedVal:e=r.undefinedVal:null===e?r.mapUndefined?a=m(n):"function"==typeof r.nullVal?a=r.nullVal:e=r.nullVal:a=m(n):a=m(n),a&&(e=a.call(n,e,t,n)),e},m=function(e){var t=e.getAttribute("data-map")||e.getAttribute("data-mapper");if(!t)return null;if("function"==typeof window[t])return window[t];if(/\./.test(t))for(var n=window,r=t.split("."),a=0;a<r.length&&(n=n[r[a]],void 0!==n);a++);else var n=null;return"function"!=typeof n?(console.error("data-map "+t+" is not a function,"),null):n},f=function(e,t,n){t=d(t,"set",e,n);var r,a=e.tagName.toLowerCase();if("input"===a){var i=e.getAttribute("type");r=i&&p[i]?i:"input"}else r=p[a]?a:"element";return p[r](e,t)},p={input:function(e,t){e.value=t},element:function(e,t){e.innerHTML=t},textarea:function(e,t){e.value=t,e.innerHTML=t},checkbox:function(e,n){n instanceof Array||console.error("checkbox value must be an Array");var r=u(e);a[r]||(t.find("[type=checkbox][name="+r+"]").prop("checked",!1),a[r]=!0);for(var i=0;i<n.length;i++)if(n[i]==e.value){e.checked=!0;break}},radio:function(e,t){t==e.value&&(e.checked=!0)},select:function(e,t){for(var n=e.querySelectorAll("option"),r=0;r<n.length;r++)t==n[r].value?n[r].selected=!0:n[r].selected=!1}},h=function(e){var t,n=e.tagName.toLowerCase();if("input"===n){var r=e.getAttribute("type");t=r&&g[r]?r:"input"}else t=g[n]?n:"element";var a=g[t](e);return d(a,"get",e)},g={element:function(e){return e.innerHTML},input:function(e){return e.value},textarea:function(e,t){return e.value},checkbox:function(e){var t=e.getAttribute("name");return r[t]||(r[t]=[]),e.checked&&r[t].push(e.value),r[t]},radio:function(e){var t=e.getAttribute("name");return void 0===r[t]&&(r[t]=""),e.checked&&(r[t]=e.value),r[t]},select:function(t){return e(t).val()}}}(jQuery),function(e){var t={events:!1,$input:null,inputHTML:'<label class="mk-filter-input-wrapper"><input type="text" class="mk-filter-input" name="filter" placeholder="filter"></label>',attr:"data-mk-filter",reindexOnCheck:!1,filterClass:"",failedClass:"mk-filter-failed",passedClass:"mk-filter-passed",triggerName:"keyup"};e.fn.mkFilter=function(e){if("string"==typeof e){var t=this.data("mkFilterInputs");if(!t)throw new Error("Given element is not mkFilter.");switch(e){case"filtrate":var n=arguments[1];n||(n=""),_checkFilter(t[0].data("mkFilterOptions"));break;case"destroy":_destroy(this);break;case"reindex":break;default:throw new Error("mkFilter: unknown command "+e)}}else _create(this,e);return this},_create=function(n,r){var a=e.extend({},t,r);a.$root=n,a.$input?1!==a.$input.length&&console.warn("mkFilter: not one input element",a.$input.length):a.$input=_createInput(a),a.$filtrates=_indexFiltrates(a),a.$input.data("mkFilterOptions",a);var i=_rememberInputInRoot(a);a.filterIndex=i-1,a.handler=_onInputChange.bind(a),a.$input.on(a.triggerName,a.handler)},_rememberInputInRoot=function(e){var t=e.$root.data("mkFilterInputs");return t||(t=[],e.$root.data("mkFilterInputs",t)),t.push(e.$input)},_createInput=function(t){var n=e(t.inputHTML).prependTo(t.$root);return console.log("_createInput",n,t),"INPUT"===n[0].tagName?n:n.find("input")},_checkFilter=function(t,n){if(console.log(t),!n){var r=t.$input.val();n=new RegExp(r,"i")}t.reindexOnCheck&&(t.$filtrates=_indexFiltrates(t));var a=[],i=[];if(t.$filtrates.each(function(){$filtrate=e(this);var r=$filtrate.attr(t.attr),o=n.test(r),s=_keepCheckResultInElement(this,t,o);s?(a.push($filtrate),$filtrate.removeClass(t.failedClass),$filtrate.addClass(t.passedClass)):(i.push($filtrate),$filtrate.removeClass(t.passedClass),$filtrate.addClass(t.failedClass))}),t.events){var o={string:r,passed:a,failed:i,options:t},s=jQuery.Event("mkFilterChange",{mkFilter:o});t.$root.triggerHandler(s)}},_addClassTo=function(e,t){var n=e.get(0);n.className+=" "+t},_removeClassFrom=function(e,t){var n=e.get(0),r=new RegExp(" "+t);n.className=n.className.replace(r,"")},_keepCheckResultInElement=function(e,t,n){e.mkFilterChecks[t.filterIndex]=n?1:0;var r=e.mkFilterChecks.reduce(function(e,t){return e*t},1);return r},_destroy=function(e){var t=e.data("mkFilterInputs");t.forEach(function(e){var t=e.data("mkFilterOptions");e.off(t.triggerName,t.handler),e.data("mkFilterOptions",null)}),e.data("mkFilterInputs",null)},_reset=function(e){},_indexFiltrates=function(e){var t=e.$root.find("["+e.attr+"]");return t.addClass(e.filterClass),t.each(function(e){this.mkFilterChecks||(this.mkFilterChecks=[])}),t},_onInputChange=function(){_checkFilter(this)}}(jQuery),function(e){e.lselect=function(t,n){if(!t)throw new Error("Can not create lselect, because selector is empty");this.options=e.extend({},this.defaults,n),this.selector=t,this.$selectee=e(this.selector),this.$selectee.addClass("lselect-item"),this.$observer=e({}),this.options.controlClass?(this.$triggers=this.$selectee.find("."+this.options.controlClass),this.$triggers.attr("onmousedown","return false;")):(this.$triggers=null,this.$selectee.addClass(this.options.controlClass),this.$selectee.attr("onmousedown","return false;")),console.log("$.lselect",this.options);var r=this;this.$selectee.on("click",function(e){r._onclick(e)})},e.lselect.prototype.defaults={controlClass:"lselect-trigger"},e.lselect.prototype._onclick=function(t){var n=e(t.target);n.hasClass(this.options.controlClass)&&(n.hasClass("selected")?(e(t.target).removeClass("selected"),t.delegateTarget!==t.target&&e(t.delegateTarget).removeClass("selected")):(e(t.target).addClass("selected"),t.delegateTarget!==t.target&&e(t.delegateTarget).addClass("selected")),e(this).triggerHandler("change"))},e.lselect.prototype.selectAll=function(){this.$selectee.addClass("selected"),this.$triggers&&this.$triggers.addClass("selected")},e.lselect.prototype.unselectAll=function(){this.$selectee.removeClass("selected"),this.$triggers&&this.$triggers.removeClass("selected")},e.lselect.prototype.selected=function(){return this.$selectee.filter(".selected")}}(jQuery),function(e){e.mkmodal={opened:!1,$wrapper:null,$dialog:null,ticket:null},e.mkmodal.defaults={content:"",data:null,title:"",messages:{loadingHTML:'Loading<b class="mka-pulse">...</b>',loadError:"Can not load dialog from file ",aquireError:"Can not aquire dialog from selector ",errorTitle:"Dialog error"},modalHTML:'<table border="0" id="mkmodalMask"><tr><td class="mkmodal-container"><div id="mkmodal"><h2 class="mkmodal-title"></h2><a class="mkmodal-control-close"></a><div class="mkmodal-body"></div></div></td></tr></table>',container:null,_fire:"open"},e.mkmodal.open=function(t){if(this.opened)throw new Error("Can not open second mkmodal");this.opened=!0,this.ticket=(new Date).getTime(),t=e.extend({},this.defaults,t);var n=t.container||document.body;this.$wrapper=e(t.modalHTML),this.$wrapper.find(".mkmodal-title").html(t.title),this.$wrapper.find(".mkmodal-body").html(this._formatContent(t)),this.$dialog=this.$wrapper.find("#mkmodal"),this.$wrapper.appendTo(n),this._appear(),this._initializeInterface(),e(this).triggerHandler(t._fire)},e.mkmodal.close=function(){void 0===e.mkmodal.$wrapper.css("animationName")?e.mkmodal.$wrapper.remove():this._disappear(),this.opened=!1,e(this).triggerHandler("close")},e.mkmodal.acquire=function(t,n){var r=e(t),a={title:r.attr("data-mkmodal-title")};n=e.extend({},this.defaults,a,n),0===r.length?(n.title=n.messages.errorTitle,n.content=n.messages.aquireError+t,n._fire="error"):n.content=r.html(),this.open(n)},e.mkmodal.load=function(t,n,r,a){n=e.extend({},this.defaults,n),n.content=this.defaults.messages.loadingHTML,this.open(n);var i=this,o=this.ticket;jQuery.ajax({url:t,success:function(t,a,s){if(o===i.ticket){n.content=t;var l=i._formatContent(n);i.$wrapper.find(".mkmodal-title").html(n.title),i.$wrapper.find(".mkmodal-body").html(l),i._initializeInterface(),r&&r.call(i),e(i).triggerHandler("loadsuccess")}},error:function(r,s,l){o===i.ticket&&(n.title=n.messages.errorTitle,n.content=n.messages.loadError+t,i.$wrapper.find(".mkmodal-title").html(n.title),i.$wrapper.find(".mkmodal-body").html(n.content),a&&a.call(r,s,l),e(i).triggerHandler("loaderror"))},async:!0})},e.mkmodal._initializeInterface=function(){this.$dialog.find(".mkmodal-close,.mkmodal-control-close").one("click",function(t){e.mkmodal.close()}),this.$dialog.on("click",function(e){e.stopPropagation()}),setTimeout(function(){e.mkmodal.$wrapper.on("click",function(){e.mkmodal.close()})},300)},e.mkmodal._unfoldMask=function(){},e.mkmodal._formatContent=function(e){var t="function"==typeof e.content?e.content():e.content;return e.data&&(t=this._insertData(t,e.data)),t},e.mkmodal._appear=function(){this.$wrapper.cssanim("mka-fade-in"),this.$dialog.cssanim("mka-ascent-in")},e.mkmodal._disappear=function(e){this.$dialog.cssanim("mka-drown-out"),this.$wrapper.cssanimRemove("mka-fade-out")},e.mkmodal._centrate=function(t){var n=e(window),r=(n.width()-t.width())/2,a=(n.height()-t.height())/2;r<0&&(r=0),a<0&&(a=0),t.css("left",r+"px"),t.css("top",a+"px")},e.mkmodal._insertData=function(e,t){if(null===t)return e;if(!e)return console.warn("dialog content is empty"),e;for(var n in t)if(t.hasOwnProperty(n)){var r=new RegExp("%"+n+"%","g");e=e.replace(r,t[n])}return e},e.mkmodal._strRender=function(e,t){placeholdStartMarker=placeholdEndMarker="%";for(var n=1;n<arguments.length;n++){t=arguments[n];for(var r in t)if(t.hasOwnProperty(r)){var a=new RegExp(placeholdStartMarker+r+placeholdEndMarker,"g");e=e.replace(a,t[r])}}return e}}(jQuery),function(e){e.pagex={$container:null,prefix:"screens/",postfix:".html",loadingPage:'<div class="mka-fade-in">Loading<b class="mka-pulse">...</b></div>',errorMessage:"Невозможно загрузить страницу",defaultPage:"home",goAttribute:"data-pagex-go",currentPage:null,prevPage:null,stack:[],cacheNumber:3,debug:!0,cache:!0,animation:{on:!0,duration:.3,forwardIn:"slide-in-from-right",forwardOut:"slide-out-to-left",backIn:"slide-in-from-left",backOut:"slide-out-to-right"},_forward:!0,_$curPageEl:null,_changing:!1,_wrapperClass:"pagex-page",_containerID:"pageContainer",_eventHandlers:{open:[],load:[],close:[],error:[]},_namedHandlers:{open:{},load:{},close:{},error:{}}},e.pagex.init=function(){if(e(window).on("hashchange",function(){e.pagex.onHashChange()}),this.$container=e(document.getElementById(this._containerID)),0===this.$container.length)console.warn("pagex: page container does not exist with selector: #"+this._containerID),this.$container=null;else{var t=this.$container.css("position");"relative"!==t&&"absolute"!==t&&"fixed"!==t&&console.warn('pagex: page container has unreliable style.position property, better use "relative","absolute" or "fixed".')}},e.pagex.initPageLoad=function(){var e=this.extractHashAlias();e&&this._loadContent(e)},e.pagex.setStyles=function(){var t=e("#pagexStyles");0===t.length&&(t=e('<style id="pagexStyles"></style>').appendTo(document.head));var n="#pageContainer{position:relative;}";n+="#pageContainer .pagex-page{position:absolute; top:0; left:0; width:100%; min-height:100%; box-sizing:border-box;}",t.html(n)},e.pagex.onHashChange=function(){var t=e.pagex.extractHashAlias();t||(t=this.defaultPage),this.currentPage&&(this.prevPage=this.currentPage),t===this.lastStack()?(this._forward=!1,this.stack.pop()):(this._forward=!0,this.prevPage&&this.stack.push(this.prevPage)),e.pagex._loadContent(t)},e.pagex.getContentLink=function(e){return this.prefix+e+this.postfix+"?"+this.cacheTicket(this.cacheNumber)},e.pagex.open=function(e){this.currentPage===e||this.extractHashAlias()===e?this._loadContent(e,!0):window.location.hash=e},e.pagex.back=function(){window.history.back()},e.pagex.lastStack=function(){return 0===this.stack.length?null:this.stack[this.stack.length-1]},e.pagex._loadContent=function(t,n){if("string"!=typeof t)throw new Error("Псевдоним страницы должен быть строкой, а не "+typeof t);if(t!==this.currentPage){this._changing=!0,this.currentPage&&this.triggerSet("close",this.currentPage);var r=this._$curPageEl;if(this.currentPage=t,this._$curPageEl=e.pagex._findPage(t),this._$curPageEl?(this._$curPageEl.css("display",""),this._$curPageEl.hasClass("pagex-load-error")?(this._$curPageEl.html(this.loadingPage),this._loadFile(t,this.currentPage)):this.triggerSet("open",this.currentPage)):(this._$curPageEl=e("<div></div>").attr("class",this._wrapperClass).attr("id",t).html(this.loadingPage).appendTo(this.$container),this._loadFile(t,this.currentPage)),this.animation.on&&!n){var a,i,o={duration:this.animation.duration,fillMode:"forwards",oncomplete:function(){e.pagex._removePageElement(this)}},s={duration:this.animation.duration,oncomplete:function(){e.pagex._changing=!1,e.pagex._$curPageEl.css("display","")}};this._forward?(a=this.animation.forwardIn,i=this.animation.forwardOut):(a=this.animation.backIn,i=this.animation.backOut),this._$curPageEl.cssanim(a,s),r&&r.cssanim(i,o)}else r&&e.pagex._removePageElement(r),e.pagex._changing=!1}},e.pagex._removePageElement=function(e){this.cache?e.css("display","none"):e.remove()},e.pagex._loadFile=function(e){jQuery.support.cors=jQuery.support.cors||this.cors;var t=this;jQuery.ajax({url:this.getContentLink(e),data:{},method:"GET",dataType:"text",crossDomain:jQuery.support.cors,success:function(n,r,a){t._printContent(n,e,!0),t.triggerSet("load",e),t.triggerSet("open",e)},error:function(n,r,a){t._printContent(t.loadErrorMessage(a),e,!1),t.triggerSet("error",e,{errorThrown:a})},async:!0})},e.pagex.loadErrorMessage=function(e){return this.debug?this.errorMessage+"<br />url: "+this.getContentLink(this.currentPage)+"<br />error thrown: "+e:this.errorMessage},e.pagex._printContent=function(e,t,n){if(void 0===n&&(n=!0),this.cache){var r=this._findPage(t);if(!r)return;r.html(e),n||r.addClass("pagex-load-error")}else{if(t!==this.currentPage)return;this._$curPageEl.html(e),n||this._$curPageEl.addClass("pagex-load-error")}},e.pagex._findPage=function(e){var t=this.$container.find('[id="'+e+'"]');return t.length?t:null},e.pagex.extractHashAlias=function(){return""===window.location.hash?"":window.location.hash.substr(1)},e.pagex.cacheTicket=function(e){return void 0===e&&(e=3),Math.floor((new Date).getTime()/Math.pow(10,e+3))},e.pagex.bind=function(t){void 0===t&&(t=document),e("["+this.goAttribute+"]",t).on("click",e.pagex.openOnEvent)},e.pagex.openOnEvent=function(t){if("object"==typeof t.delegateTarget){var n=e(t.delegateTarget).attr(jQuery.pagex.goAttribute);e.pagex.open(n)}},e.pagex.on=function(e,t,n){if("string"==typeof t){if("function"!=typeof n)throw new Error("$.pagex.on(): event handler is not a function!");this._namedHandlers[e][t]||(this._namedHandlers[e][t]=[]),this._namedHandlers[e][t].push(n)}else{if("function"!=typeof t)throw new Error("$.pagex.on(): wrong type of arguments");n=t,this._eventHandlers[e].push(n)}},e.pagex.off=function(e,t,n){var r;if("string"==typeof t){if(r=this._namedHandlers[e][t],!r)return}else{if("function"!=typeof t)throw new Error("$.pagex.off(): wrong type of arguments");if(r=this._eventHandlers[e],!r)return;n=t}for(var a=0;a<r.length;a++)r[a]===n&&r.splice(a--,1)},e.pagex.triggerSet=function(e,t,n){this.triggerNamed(e,t,n),this.triggerUnnamed(e,t,n)},e.pagex.triggerNamed=function(e,t,n){if(!t)throw new Error("$.pagex.triggerNamed(): pageAlias is obligatory");var r=this._namedHandlers[e][t];if(r)for(var a=this.event(e,t,n),i=0;i<r.length;i++)r[i].call(this,a)},e.pagex.event=function(e,t,n){var r=n||{};return r.type=e,r.pageAlias=t,r.pageElement=this._findPage(t).get(0),r.delegateTarget=r.targetPageElement,r.target=this,r},e.pagex.triggerUnnamed=function(e,t,n){if(!t)throw new Error("$.pagex.triggerNamed(): pageAlias is obligatory");var r=this._eventHandlers[e];if(r)for(var a=this.event(e,t,n),i=0;i<r.length;i++)r[i].call(this,a)}}(jQuery),$(function(){$.pagex.init()}),function(){var e="%",t="%";simpleRender=function(e,t){return arguments.length>2?r.apply(this,arguments):t instanceof Array?a(e,t):n(e,t)},clearSimplePlaceholders=function(n,r){var a=new RegExp(e+".+?"+t,"g");return r||(r=""),n.replace(a,r)},simpleMarks=function(){return(arguments.length=2)?(e=arguments[0],t=arguments[1]):(arguments.length=1)&&(e=arguments[0],t=arguments[0]),[e,t]},String.prototype.simpleRender?console.warn("String.simpleRender() already exists."):String.prototype.simpleRender=function(){for(var e=[this],t=0;t<arguments.length;t++)e.push(arguments[t]);return simpleRender.apply(this,e)},String.prototype.clearSimplePlaceholders?console.warn("String.clearSimplePlaceholders() already exists."):String.prototype.clearSimplePlaceholders=function(e){return clearSimplePlaceholders(this,e)};var n=function(n,r){for(var a in r)if(r.hasOwnProperty(a)){var i=new RegExp(e+a+t,"g");n=n.replace(i,r[a])}return n},r=function(e){for(var t=1;t<arguments.length;t++)e=n(e,arguments[t]);return e},a=function(e,t){for(var r="",a=0;a<t.length;a++)r+=n(e,t[a]);return r}}(),window.mk||(mk={}),mk.drawer={},mk.drawer.defaults={content:null,"class":null,overlay:!0},mk.drawer.addClass=function(e,t){var n=new RegExp("(^|\\s)"+t+"(\\s|$)","g");n.test(e.className)||(e.className=(e.className+" "+t).replace(/\s+/g," ").replace(/(^ | $)/g,""))},mk.drawer.removeClass=function(e,t){var n=new RegExp("(^|\\s)"+t+"(\\s|$)","g");e.className=e.className.replace(n,"$1").replace(/\s+/g," ").replace(/(^ | $)/g,"")},mk.drawer.hasClass=function(e,t){var n=new RegExp("(^|\\s)"+t+"(\\s|$)","g");return n.test(e.className)},mk.drawer.normalizeOptions=function(e){void 0===e&&(e={});for(var t in this.defaults)!this.defaults.hasOwnProperty*t||void 0===e[t]&&(e[t]=this.defaults[t]);return e},mk.drawer.toggle=function(e){var t=e,n=t.querySelector(".mk-drawer-body"),r=t.drawerOptions.overlay;this.hasClass(t,"mk-open")?(this.removeClass(t,"mk-open"),r&&this.removeClass(r,"mk-open"),setTimeout(function(){n.style.display="none",r&&(r.style.display="none")},350)):(n.style.display="",mk.drawer.addClass(t,"mk-open"),
r&&(r.style.display="",setTimeout(function(){mk.drawer.addClass(r,"mk-open")},20)))},mk.drawer.create=function(e,t){if(e.ownerDocument!==document&&"object"==typeof e?(t=e,t=mk.drawer.normalizeOptions(t),e=t.content):t=mk.drawer.normalizeOptions(t),!e)return void console.error("No content supplied for drawer");var n=document.createElement("div");n.className="mk-drawer-wrapper",t["class"]&&(n.className+=" "+t["class"]),n.drawerOptions={};var r=document.createElement("div");r.className="mk-drawer-pouch";var a=document.createElement("div");if(a.className="mk-drawer-body",r.appendChild(a),e.ownerDocument===document){var i=this._defineParent(e);a.appendChild(e)}else{a.innerHTML=e;var i=document.body}if(document.body===i&&(n.style.position="fixed"),t.overlay){var o=i.querySelector(".mk-drawer-overlay");o||(o=document.createElement("div"),o.className="mk-drawer-overlay",o.style.display="none",o.onclick=function(){var e=this.parentNode.querySelector(".mk-drawer-wrapper.mk-open");mk.drawer.toggle(e)},i.appendChild(o)),n.drawerOptions.overlay=o,document.body===i&&(o.style.position="fixed")}var s=document.createElement("button");return s.className="mk-drawer-trigger",s.onclick=function(){mk.drawer.toggle(this.parentNode)},s.innerHTML='<span class="mk-drawer-icon mk-icon-close"></span>',n.appendChild(s),n.appendChild(r),i.appendChild(n),n},mk.drawer._defineParent=function(e){var t=e.parentNode,n=t.style.position;return"fixed"!==n&&"relative"!==n&&"absolute"!==n&&(t.style.position="relative"),t},window.mk||(mk={}),mk.slidemenu={},mk.slidemenu.defaults={backButtonContent:"Back",className:"",width:null,height:null},mk.slidemenu.gointo=function(e){var t=mk.slidemenu.getRoot(e),n=e.parentNode,r=n.parentNode,a=n.querySelector("ul");t.appendChild(a),setTimeout(function(){mk.u.removeClass(a,"mk-away-right")},20),mk.u.addClass(r,"mk-away-left")},mk.slidemenu.goback=function(e){var t=e.parentLi,n=t.parentNode,r=e.parentNode.parentNode;mk.u.removeClass(n,"mk-away-left"),mk.u.addClass(r,"mk-away-right"),setTimeout(function(){t.appendChild(r)},500)},mk.slidemenu.getRoot=function(e){for(var t=e,n="mk-slidemenu-container";!mk.u.hasClass(t,n);)if(t=t.parentNode,document===t){console.error("slidemenu container did not found.");break}return t},mk.slidemenu.prepend=function(e,t){e.insertBefore(t,e.childNodes[0])},mk.slidemenu.create=function(e,t){t=mk.u.merge(mk.slidemenu.defaults,t);var n=mk.u.wrap(e,"div",{"class":"mk-slidemenu-container"});return t.className&&(n.className+=" "+t.className),t.width&&(n.style.width=t.width),t.height&&(n.style.height=t.height),mk.slidemenu.processList(e,t),n},mk.slidemenu.processList=function(e,t){for(var n=e.querySelectorAll("ul"),r=0;r<n.length;r++){var a=n[r];mk.u.addClass(a.parentNode,"mk-has-children"),mk.u.addClass(a,"mk-away-right");var i=a.parentNode.querySelector("a");i&&a.parentNode===i.parentNode?(i.onclick=function(){mk.slidemenu.gointo(this)},mk.slidemenu.prependBackButton(a,t.backButtonContent)):console.error("can not create slide-trigger, because no A tag inside LI tag",a.parentNode)}},mk.slidemenu.prependBackButton=function(e,t){if("mk-slidemenu-back"!==e.childNodes[0].className){var n=document.createElement("li"),r=document.createElement("a");n.className="mk-slidemenu-back",r.innerHTML=t,r.parentLi=e.parentNode,r.onclick=function(){mk.slidemenu.goback(r)},n.appendChild(r),mk.slidemenu.prepend(e,n)}};